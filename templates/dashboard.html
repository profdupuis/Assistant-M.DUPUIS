<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Tableau de bord â€“ Assistant</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
  <link rel="icon" href="/static/img/favicon.ico" type="image/x-icon">
  <!-- (Optionnel) -->
  <link rel="icon" href="/static/img/favicon-32.png" type="image/png" sizes="32x32">
  <script src="{{ url_for('static', filename='js/keyboard_detector.js') }}"></script>
</head>
<body>
  <div class="dashboard-container">


  <h1>ğŸ“ Tableau de bord enseignant</h1>

  <div class="flash-messages">
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="flash-messages">
          {% for category, message in messages[-1:] %} {# â” Ne prend que le dernier flash #}
            <div class="flash {{ category }}">{{ message }}</div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}
  </div>
  
  <form method="post" action="{{ url_for('activate_scenario') }}" class="scenario-action rgpd-form">
    <fieldset>
      <legend>ğŸ›ï¸ Activer un scÃ©nario</legend>
      <label>Classe :
        <select name="class_name">
          {% for cl in all_classes %}
          <option value="{{ cl }}">{{ cl }}</option>
          {% endfor %}
        </select>
      </label>
      <label>ScÃ©nario :
        <select name="scenario_id">
          {% for s in all_scenarios %}
          <option value="{{ s.id }}">
            {{ s.class_name }} â€“ {{ s.name }}{% if s.is_active %} âœ…{% endif %}
          </option>
          {% endfor %}
        </select>
      </label>
      <button type="submit">âœ… Activer</button>
    </fieldset>
  </form>

  <form method="post" action="{{ url_for('delete_scenario') }}" class="scenario-action rgpd-form">
    <fieldset>
      <legend>ğŸ—‘ï¸ Supprimer un scÃ©nario</legend>
      <label>ScÃ©nario :
        <select name="scenario_id">
          {% for s in all_scenarios %}
          <option value="{{ s.id }}" {% if s.is_active %}title="ScÃ©nario actuellement actif"{% endif %}>
            {{ s.class_name }} â€“ {{ s.name }}{% if s.is_active %} âš ï¸ actif{% endif %}
          </option>
          {% endfor %}
        </select>
      </label>
      <button type="submit" onclick="return confirm('Confirmer la suppression ?')">Supprimer</button>
    </fieldset>
  </form>

  <form method="post" enctype="multipart/form-data"
        action="{{ url_for('upload_scenario') }}" class="scenario-action rgpd-form">
    <fieldset>
      <legend>ğŸ“‚ Importer un scÃ©nario (.txt)</legend>
      <input type="file" name="fichier" accept=".txt" required>
      <button type="submit">Importer</button>
    </fieldset>
  </form>


  <form method="get" action="{{ url_for('dashboard_eleve') }}" class="scenario-action">
    <fieldset>
      <legend>ğŸ“ˆ Analyser les rÃ©sultats par Ã©lÃ¨ve</legend>
      <p>AccÃ©der Ã  l'analyse dÃ©taillÃ©e des performances par classe, scÃ©nario et Ã©lÃ¨ve.</p>
      <button type="submit">Voir le tableau</button>
    </fieldset>
  </form>

  <form method="get" action="{{ url_for('dashboard_rgpd') }}" class="scenario-action">
    <fieldset>
      <legend>ğŸ›¡ï¸ GÃ©rer les consentements RGPD</legend>
      <p>Voir les consentements donnÃ©s par les Ã©lÃ¨ves et gÃ©rer leur droit Ã  l'effacement.</p>
      <button type="submit">AccÃ©der Ã  la gestion RGPD</button>
    </fieldset>
  </form>
 


  <div class="dashboard-footer">
    <span>ğŸ”’ ConnectÃ© en tant quâ€™administrateur</span>

    <a href="{{ url_for('admin_logout') }}">Se dÃ©connecter</a>
  </div>
</div>
</body>
</html>
